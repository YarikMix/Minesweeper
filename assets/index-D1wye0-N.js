var O=Object.defineProperty;var T=(e,t,i)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var h=(e,t,i)=>(T(e,typeof t!="symbol"?t+"":t,i),i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const v of a.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&n(v)}).observe(document,{childList:!0,subtree:!0});function i(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=i(r);fetch(r.href,a)}})();const E=500;var c=(e=>(e[e.Custom=0]="Custom",e[e.Easy=1]="Easy",e[e.Medium=2]="Medium",e[e.Hard=3]="Hard",e))(c||{}),u=(e=>(e[e.Playing=0]="Playing",e[e.Lost=1]="Lost",e[e.Won=2]="Won",e))(u||{}),d=(e=>(e[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden",e[e.Flagged=2]="Flagged",e))(d||{});class C{constructor(t,i,n=!1,r=0,a=d.Hidden){h(this,"x");h(this,"y");h(this,"hasMine");h(this,"danger");h(this,"currentState");this.x=t,this.y=i,this.hasMine=n,this.danger=r,this.currentState=a}calcDanger(){let t=f[l.difficulty];for(let i=this.y-1;i<=this.y+1;i++)for(let n=this.x-1;n<=this.x+1;n++)n==this.x&&i==this.y||n<0||i<0||n>=t.width||i>=t.height||s[i*t.width+n].hasMine&&this.danger++}flag(){this.currentState==d.Hidden?this.currentState=d.Flagged:this.currentState==d.Flagged&&(this.currentState=d.Hidden)}click(){this.currentState==d.Hidden&&(this.hasMine&&!l.firstTry?V():this.danger>0?this.currentState=d.Visible:(this.currentState=d.Visible,this.revealNeighbours()),l.firstTry=!1,k())}revealNeighbours(){let t=f[l.difficulty];for(let i=this.y-1;i<=this.y+1;i++)for(let n=this.x-1;n<=this.x+1;n++){if(n==this.x&&i==this.y||n<0||i<0||n>=t.width||i>=t.height)continue;let r=i*t.width+n;s[r].currentState==d.Hidden&&(s[r].currentState=d.Visible,s[r].danger==0&&s[r].revealNeighbours())}}}let s=[],l={difficulty:c.Easy,state:u.Playing,tileW:50,tileH:50,firstTry:!0},f={[c.Custom]:{name:c.Custom,width:9,height:9,mines:10},[c.Easy]:{name:c.Easy,width:9,height:9,mines:10},[c.Medium]:{name:c.Medium,width:16,height:16,mines:40},[c.Hard]:{name:c.Hard,width:16,height:30,mines:99}};function k(){for(let e in s)if(!s[e].hasMine&&s[e].currentState!=d.Visible)return;l.state=u.Won}function V(){l.state=u.Lost}function F(){if(localStorage.getItem("save")){const e=JSON.parse(localStorage.getItem("save"));l=e.GameInfo,s=e.grid.map(t=>new C(t.x,t.y,t.hasMine,t.danger,t.currentState)),f=e.difficulties,w()}else y(c.Easy)}function y(e){l.difficulty=e,l.state=u.Playing,l.firstTry=!0,s.length=0;let t=f[e];l.tileW=E/t.width,l.tileH=E/t.height;for(let n=0;n<t.height;n++)for(let r=0;r<t.width;r++)s.push(new C(r,n));let i=0;for(;i<t.mines;){let n=Math.floor(Math.random()*s.length);s[n].hasMine||(s[n].hasMine=!0,i++)}for(let n in s)s[n].calcDanger();w()}function M(e,t,i=!1){if(l.state==u.Won||l.state==u.Lost){y(l.difficulty);return}let n=f[l.difficulty],r=Math.floor(e/l.tileW),a=Math.floor(t/l.tileH);const v=r+a*n.width,S=s[v];S.currentState!=d.Visible&&i?(S.flag(),w()):S.currentState==d.Hidden&&(S.click(),w())}function w(){let e=l.tileW/2,t=l.tileH/2,i=f[l.difficulty];P.innerText="ðŸ’£"+i.mines,l.state==u.Lost||l.state==u.Won?(p.classList.add("active"),p.innerText=l.state==u.Lost?"Ð’Ñ‹ Ð¿Ñ€Ð¾Ð¸Ð³Ñ€Ð°Ð»Ð¸ ðŸ˜”":"Ð’Ñ‹ Ð¿Ð¾Ð±ÐµÐ´Ð¸Ð»Ð¸ ðŸ¥³!"):(p.classList.remove("active"),p.innerText=""),o.font="bold 16px monospace",o.textAlign="center",o.textBaseline="middle";for(let n in s){let r=s[n].x*l.tileW,a=s[n].y*l.tileH;(l.state==u.Lost||l.state==u.Won)&&s[n].hasMine?(o.fillStyle="#ff0000",o.fillRect(r,a,l.tileW,l.tileH),o.fillText("ðŸ’£",r+e,a+t)):s[n].currentState==d.Visible?(o.fillStyle="#dddddd",o.fillRect(r,a,l.tileW,l.tileH),s[n].danger&&(o.fillStyle="#000",o.fillText(s[n].danger.toString(),r+e,a+t))):(o.fillStyle="#ccc",o.fillRect(r,a,l.tileW,l.tileH),o.strokeRect(r,a,l.tileW,l.tileH),s[n].currentState==d.Flagged&&o.fillText("ðŸš©",r+e,a+t))}g.value=i.width.toString(),m.value=i.height.toString(),x.value=i.mines.toString(),I.value=c[l.difficulty],localStorage.setItem("save",JSON.stringify({GameInfo:l,grid:s,difficulties:f}))}function L(e,t){let i=document.getElementById("game");do e-=i.offsetLeft,t-=i.offsetTop,i=i.offsetParent;while(i!=null);return[e,t]}let o,b,W,B,I,N,g,m,x,P,p;window.onload=function(){b=document.getElementById("game"),B=document.getElementById("click-type"),W=document.getElementById("reset-btn"),I=document.getElementById("difficulty-options"),N=document.getElementById("apply-settings-btn"),g=document.getElementById("width"),m=document.getElementById("height"),x=document.getElementById("mines"),P=document.getElementById("mines-count"),p=document.getElementById("game-state"),p.addEventListener("click",function(){y(l.difficulty)}),o=b.getContext("2d"),b.addEventListener("click",function(e){const t=B.value=="right",[i,n]=L(e.pageX,e.pageY);M(i,n,t)}),b.addEventListener("contextmenu",function(e){e.preventDefault();const[t,i]=L(e.pageX,e.pageY);return M(t,i,!0),!1}),W.addEventListener("click",function(){y(l.difficulty)}),I.addEventListener("change",function(e){const{value:t}=e.currentTarget;y(c[t])}),N.addEventListener("click",function(e){e.preventDefault(),g.value=H(g.value,2,30),m.value=H(m.value,2,30),x.value=H(x.value,1,Number(g.value)*Number(m.value)-1),f[c.Custom].width=Number(g.value),f[c.Custom].height=Number(m.value),f[c.Custom].mines=Number(x.value),y(c.Custom)}),o.fillStyle="#ddddee",o.fillRect(0,0,E,E),F()};function H(e,t,i){const n=parseInt(e);return Math.min(Math.max(n,t),i).toString()}
